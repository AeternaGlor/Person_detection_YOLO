# Выявление людей в видео потоке
Данная работа была создана в результате выплонения задачи "Разработка алгоритма для выявление людей в видео потоке с использованием технологии искусственного интеллекта на объектах газотранспортной сети", поставленной в рамках летней практикии.

В результате с помощью модели YOLOv8 и библиотеки OpenCV была создана программа для обнаружения и подсчёта людей на кадрах в видеопотоке.

## Суть работы алгоритма
Разработанный алгоритм на основе исходного видеоролика, поступающего на его вход, создаёт временной ряд, содержащий информацию о среднем количестве человек в кадрах для каждой секунды видео. Кроме того, с использованием средств библиотеки OpenCV формируется выходной видеофайл, содержащий преобразованные кадры исходного видео, отображающие информацию, полученную с помощью моделей YOLO

### Примеры работы
Примеры исходного видео и результатов его обработки можно найти в папке data.
Исходному видео "mini - Trim.mkv" соотвествтвует выходной видеофайл "detect.mp4".
Исходному видео "mini2.mkv" - видео с префиксом "detect3_..."

Кадры ниже взяты из исходного видео "mini2.mkv" и результата его обработки - файла "detect3_by_yolov8s.pt.mp4".

Кадр исходного видеофайла:
![image](https://github.com/user-attachments/assets/dcc7c1cb-af4a-4d59-b185-218b81c8a5b3)

Кадр выходного видеофайла, полученного с помощью модели yolov8s:
![image](https://github.com/user-attachments/assets/b451eb6e-520b-430e-bf32-89a16e8aa768)


Временной ряд:

![image](https://github.com/user-attachments/assets/c1779663-e39a-4ac8-80ef-b40e5a0ead33)



## Сравнение моделей разных размеров
Все измерения времени работы алгоритма проводились с использованием ресурсов Google Colab на примере двух небольших исходных видео и являются только примерным показателем того, как некоторые изменения в работе программы могут влиять на её время работы.
### С учётом времени создания выходного файла
Сравнение времени работы алгоритма при использовании моделей разных размеров на нескольких видео показало, что при создании выходного файла модель максимального размера Huge (yolov8x) работает примерно на 45% медленнее, чем модель наименьшего размера Nano (yolov8n).

![image](https://github.com/user-attachments/assets/6849dff3-5f34-498a-a25f-29d3574fb252)

### Без учёта времени создания выходного файла
Ели же не учитывать время создания выходного файла, то разница становится даже заметнее – модель yolov8x обрабатывает видео в среднем на 60% медленнее, чем модель yolov8n. А сам процесс создания выходного видеофайла замедляет работу в среднем на 35%.

![image](https://github.com/user-attachments/assets/e6935058-819a-4868-8703-0dfd027c4a78)



